# Customer Frontend - User Flows

## Flow 1: í…Œì´ë¸” ë¡œê·¸ì¸ ë° ë©”ë‰´ ì¡°íšŒ

```
[ê³ ê°] QR ì½”ë“œ ìŠ¤ìº”
    â†“
[QRScanPage] QR ì½”ë“œ ì¸ì‹
    â†“
[API] POST /api/customer/auth/login
    â†“
[SessionStorage] sessionToken, tableNumber, tableId ì €ì¥
    â†“
[Navigate] /menu
    â†“
[MenuListPage] ë©”ë‰´ ëª©ë¡ ë¡œë“œ
    â†“
[API] GET /api/customer/menu/list
    â†“
[Display] ì¹´í…Œê³ ë¦¬ + ë©”ë‰´ í‘œì‹œ
```

**Success Case**:
- QR ì½”ë“œ ìœ íš¨ â†’ ë©”ë‰´ í˜ì´ì§€ ì´ë™
- ë©”ë‰´ ëª©ë¡ í‘œì‹œ

**Error Cases**:
- QR ì½”ë“œ ë¬´íš¨ â†’ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- ì´ë¯¸ í™œì„± ì„¸ì…˜ ì¡´ì¬ â†’ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ â†’ ì¬ì‹œë„ ë²„íŠ¼ í‘œì‹œ

---

## Flow 2: ë©”ë‰´ ì„ íƒ ë° ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°

```
[ê³ ê°] ë©”ë‰´ ì¹´ë“œ í´ë¦­
    â†“
[MenuListPage] MenuDetailModal ì—´ê¸°
    â†“
[MenuDetailModal] ë©”ë‰´ ìƒì„¸ ì •ë³´ í‘œì‹œ
    â†“
[ê³ ê°] ìˆ˜ëŸ‰ ì„ íƒ (+/- ë²„íŠ¼)
    â†“
[ê³ ê°] "ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°" í´ë¦­
    â†“
[MenuListPage] cart ìƒíƒœ ì—…ë°ì´íŠ¸
    â†“
[MenuDetailModal] ë‹«ê¸°
    â†“
[Display] ì¥ë°”êµ¬ë‹ˆ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸ (ê°œìˆ˜ í‘œì‹œ)
```

**Business Rules**:
- ìˆ˜ëŸ‰ ìµœì†Œê°’: 1
- ìˆ˜ëŸ‰ ìµœëŒ€ê°’: 99
- í’ˆì ˆ ë©”ë‰´(is_available=false): ë‹´ê¸° ë²„íŠ¼ ë¹„í™œì„±í™”

---

## Flow 3: ì£¼ë¬¸ ìƒì„± (íŒ í¬í•¨)

```
[ê³ ê°] "ì£¼ë¬¸í•˜ê¸°" ë²„íŠ¼ í´ë¦­
    â†“
[Navigate] /order
    â†“
[OrderPage] ì£¼ë¬¸ ìš”ì•½ í‘œì‹œ
    â†“
[ê³ ê°] íŒ ë¹„ìœ¨ ì„ íƒ (0%, 5%, 10%, 15%, 20%)
    â†“
[OrderPage] íŒ ê¸ˆì•¡ ìë™ ê³„ì‚°
    â†“
[Display] ì´ ê¸ˆì•¡ ì—…ë°ì´íŠ¸
    â†“
[ê³ ê°] "ì£¼ë¬¸ í™•ì •" ë²„íŠ¼ í´ë¦­
    â†“
[API] POST /api/customer/order/create
    â†“
[Navigate] /status
    â†“
[OrderStatusPage] ì£¼ë¬¸ ìƒíƒœ í‘œì‹œ
```

**Calculation Logic**:
```
subtotal = sum(menu.price * quantity)
tipAmount = round(subtotal * tipRate / 100)
totalAmount = subtotal + tipAmount
```

**Success Case**:
- ì£¼ë¬¸ ìƒì„± ì„±ê³µ â†’ ì£¼ë¬¸ ìƒíƒœ í˜ì´ì§€ ì´ë™
- ì¥ë°”êµ¬ë‹ˆ ì´ˆê¸°í™”

**Error Cases**:
- ì„¸ì…˜ ë¹„í™œì„± â†’ ì—ëŸ¬ ë©”ì‹œì§€ + ë¡œê·¸ì¸ í˜ì´ì§€ ì´ë™
- ë©”ë‰´ í’ˆì ˆ â†’ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ â†’ ì¬ì‹œë„ ë²„íŠ¼ í‘œì‹œ

---

## Flow 4: ì£¼ë¬¸ ìƒíƒœ í™•ì¸

```
[OrderStatusPage] ì£¼ë¬¸ ëª©ë¡ ë¡œë“œ
    â†“
[API] GET /api/customer/order/list
    â†“
[Display] ì£¼ë¬¸ ì¹´ë“œ ëª©ë¡ í‘œì‹œ
    â†“
[Polling] 5ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ 
    â†“
[API] GET /api/customer/order/list
    â†“
[Update] ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸
```

**Status Display**:
- `pending`: "ì£¼ë¬¸ ì ‘ìˆ˜ë¨" (íšŒìƒ‰)
- `preparing`: "ì¡°ë¦¬ ì¤‘" (ì£¼í™©ìƒ‰)
- `ready`: "ì¤€ë¹„ ì™„ë£Œ" (ì´ˆë¡ìƒ‰)
- `served`: "ì„œë¹™ ì™„ë£Œ" (íŒŒë€ìƒ‰)

**Polling Logic**:
- í˜ì´ì§€ í™œì„±í™” ì‹œ í´ë§ ì‹œì‘
- í˜ì´ì§€ ë¹„í™œì„±í™” ì‹œ í´ë§ ì¤‘ì§€
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ í´ë§ ê³„ì† (ì—ëŸ¬ í‘œì‹œ ì•ˆ í•¨)

---

## Flow 5: ì¶”ê°€ ì£¼ë¬¸

```
[OrderStatusPage] "ì¶”ê°€ ì£¼ë¬¸" ë²„íŠ¼ í´ë¦­
    â†“
[Navigate] /menu
    â†“
[MenuListPage] ë©”ë‰´ ëª©ë¡ í‘œì‹œ
    â†“
[ê³ ê°] ë©”ë‰´ ì„ íƒ ë° ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°
    â†“
[ê³ ê°] "ì£¼ë¬¸í•˜ê¸°" í´ë¦­
    â†“
[Flow 3] ì£¼ë¬¸ ìƒì„± í”Œë¡œìš° ì‹¤í–‰
```

**Business Rule**:
- ê¸°ì¡´ ì£¼ë¬¸ì— ì¶”ê°€ (ìƒˆ ì£¼ë¬¸ ë²ˆí˜¸ ìƒì„±)
- ì„¸ì…˜ì´ ìœ íš¨í•œ ë™ì•ˆ ì—¬ëŸ¬ ë²ˆ ì£¼ë¬¸ ê°€ëŠ¥

---

## Flow 6: ì„¸ì…˜ ì¢…ë£Œ

```
[OrderStatusPage] "ê³„ì‚°í•˜ê¸°" ë²„íŠ¼ í´ë¦­
    â†“
[Confirm] í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ
    â†“
[ê³ ê°] "í™•ì¸" í´ë¦­
    â†“
[API] POST /api/customer/auth/logout
    â†“
[SessionStorage] ì„¸ì…˜ ì •ë³´ ì‚­ì œ
    â†“
[Navigate] /scan
    â†“
[QRScanPage] QR ìŠ¤ìº” ëŒ€ê¸°
```

**Confirmation Message**:
"ê³„ì‚°ì„ ìš”ì²­í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´í›„ ì¶”ê°€ ì£¼ë¬¸ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤."

**Success Case**:
- ì„¸ì…˜ ì¢…ë£Œ ì„±ê³µ â†’ QR ìŠ¤ìº” í˜ì´ì§€ ì´ë™

**Error Cases**:
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ â†’ ì¬ì‹œë„ ë²„íŠ¼ í‘œì‹œ
- ì„¸ì…˜ ì´ë¯¸ ì¢…ë£Œë¨ â†’ QR ìŠ¤ìº” í˜ì´ì§€ ì´ë™

---

## Flow 7: ì•ŒëŸ¬ì§€ ì •ë³´ í™•ì¸

```
[MenuListPage] ë©”ë‰´ ì¹´ë“œ í´ë¦­
    â†“
[MenuDetailModal] ì—´ê¸°
    â†“
[Display] ì•ŒëŸ¬ì§€ ì •ë³´ í‘œì‹œ
    â†“
[ê³ ê°] ì•ŒëŸ¬ì§€ ì •ë³´ í™•ì¸
```

**Allergen Display**:
- ì•„ì´ì½˜ + í…ìŠ¤íŠ¸ í˜•íƒœ
- ì˜ˆ: ğŸ¥œ ë•…ì½©, ğŸ¥› ìš°ìœ , ğŸ¦ ê°‘ê°ë¥˜

**Business Rule**:
- allergens í•„ë“œê°€ nullì´ë©´ "ì•ŒëŸ¬ì§€ ì •ë³´ ì—†ìŒ" í‘œì‹œ
- ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ì•ŒëŸ¬ì§€ ëª©ë¡ íŒŒì‹±

---

## Error Handling

### Network Errors
- ì¬ì‹œë„ ë²„íŠ¼ í‘œì‹œ
- ì—ëŸ¬ ë©”ì‹œì§€: "ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."

### Session Errors
- ì„¸ì…˜ ë§Œë£Œ ì‹œ ìë™ ë¡œê·¸ì•„ì›ƒ
- QR ìŠ¤ìº” í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- ì—ëŸ¬ ë©”ì‹œì§€: "ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”."

### Validation Errors
- ì…ë ¥ í•„ë“œ í•˜ì´ë¼ì´íŠ¸
- ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- ì˜ˆ: "ìˆ˜ëŸ‰ì€ 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤."

---

## Navigation Rules

### Route Guards
```typescript
// Protected routes
if (!sessionToken) {
  navigate('/scan');
}

// Already logged in
if (sessionToken && currentRoute === '/scan') {
  navigate('/menu');
}
```

### Back Button Behavior
- `/menu` â†’ ë’¤ë¡œê°€ê¸° ë¶ˆê°€ (ì„¸ì…˜ ì¢…ë£Œ í•„ìš”)
- `/order` â†’ `/menu`
- `/status` â†’ ë’¤ë¡œê°€ê¸° ë¶ˆê°€ (ì¶”ê°€ ì£¼ë¬¸ ë²„íŠ¼ ì‚¬ìš©)

---

**Document Version**: 1.0  
**Last Updated**: 2026-02-09  
**Status**: Draft
